From 59681e0eb305262aeb93675c66f21727bfc7ab98 Mon Sep 17 00:00:00 2001
From: Quanah Gibson-Mount <quanah@openldap.org>
Date: Mon, 30 Apr 2018 17:27:36 +0000
Subject: [PATCH 009/109] ITS#8840 Fix domainScope control to ensure the
 control value is absent as per Microsoft specification
 (https://msdn.microsoft.com/en-us/library/aa366979%28v=vs.85%29.aspx).

---
 servers/slapd/controls.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/servers/slapd/controls.c b/servers/slapd/controls.c
index b8edd39bc..16b580633 100644
--- a/servers/slapd/controls.c
+++ b/servers/slapd/controls.c
@@ -1660,8 +1660,8 @@ static int parseDomainScope (
 		return LDAP_PROTOCOL_ERROR;
 	}
 
-	if ( BER_BVISNULL( &ctrl->ldctl_value )) {
-		rs->sr_text = "domainScope control value not empty";
+	if ( !BER_BVISNULL( &ctrl->ldctl_value )) {
+		rs->sr_text = "domainScope control value not absent";
 		return LDAP_PROTOCOL_ERROR;
 	}
 
-- 
2.19.1

